<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <title>Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø³ÙˆØ´Ø§Ù„ Ù…ÙŠØ¯ÙŠØ§</title>

    <!-- Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª FontAwesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />

    <!-- Ù…Ù„Ù Ø§Ù„Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ -->
    <link rel="stylesheet" href="assets/css/style.css" />
  </head>

  <body class="home-body">
    <div class="app-layout">
      <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø¹Ù„ÙˆÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
      <header class="top-nav">
        <div class="top-nav-left">
          <div class="logo-circle">S</div>
          <div class="logo-text">Social App</div>
        </div>

        <div class="top-nav-center">
          <div class="search-box">
            <input
              type="text"
              placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†Ø´ÙˆØ±ØŒ ØµØ¯ÙŠÙ‚ØŒ Ø£Ùˆ Ù‡Ø§Ø´ØªØ§Øº..."
            />
            <i class="fa-solid fa-magnifying-glass"></i>
          </div>
        </div>

        <div class="top-nav-right">
          <button class="icon-btn" title="Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©">
            <i class="fa-solid fa-house"></i>
          </button>
          <button class="icon-btn" title="Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª">
            <i class="fa-regular fa-bell"></i>
            <span class="badge" id="notifBadge">3</span>
          </button>
          <button class="icon-btn" title="Ø§Ù„Ø±Ø³Ø§Ø¦Ù„">
            <i class="fa-regular fa-comments"></i>
          </button>

          <!-- ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… + Ø§Ù„Ø§Ø³Ù…ØŒ Ù„Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ -->
          <div class="nav-user" onclick="window.location.href='profile.html'">
            <img
              id="navUserAvatar"
              class="nav-user-avatar"
              src="https://via.placeholder.com/64x64?text=User"
              alt="user"
            />
            <span class="nav-user-name" id="navUserName">Ù…Ø³ØªØ®Ø¯Ù…</span>
          </div>

          <!-- Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù†Ø´Ø§Ù„ Ù…Ù† Ø§Ù„Ù‡ÙŠØ¯Ø± Ù‡Ù†Ø§ØŒ Ø±Ø­ Ù†Ø®Ù„ÙŠÙ‡ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ -->
        </div>
      </header>

      <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
      <div class="main-layout">
        <!-- Ø³Ø§ÙŠØ¯Ø¨Ø§Ø± ÙŠØ³Ø§Ø±: Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ ÙˆØ§Ù„ØªÙ†Ù‚Ù„ -->
        <aside class="sidebar-left">
          <div class="side-profile">
            <img
              id="sideUserAvatar"
              class="side-avatar"
              src="https://via.placeholder.com/80x80?text=User"
              alt="avatar"
            />
            <div class="side-username" id="sideUserName">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</div>
            <div class="side-email" id="sideUserEmail">user@example.com</div>
            <div class="welcome-text" id="welcomeUser">Ù…Ø±Ø­Ø¨Ø§Ù‹ ğŸ‘‹</div>
          </div>

          <a class="side-link" href="index.html">
            <i class="fa-solid fa-house"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
          </a>
          <a class="side-link" href="profile.html">
            <i class="fa-regular fa-user"></i> Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
          </a>
          <div class="side-link">
            <i class="fa-regular fa-bell"></i> Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
          </div>
          <div class="side-link">
            <i class="fa-regular fa-comments"></i> Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©
          </div>

          <!-- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù†Ø´Ø§Ù„ÙˆØ§ Ù…Ù† Ù‡ÙˆÙ†ØŒ Ø±Ø­ ÙŠÙƒÙˆÙ†ÙˆØ§ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ -->
        </aside>

        <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù€ Feed ÙÙ‚Ø· (Ø¨Ø¯ÙˆÙ† Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†Ø´ÙˆØ±) -->
        <main class="feed-area">
          <!-- Ù…Ø§ Ø¹Ø§Ø¯ ÙÙŠ create-post-wrapper Ù‡ÙˆÙ† -->

          <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª -->
          <h2 class="section-heading">Ø¢Ø®Ø± Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª</h2>
          <div id="posts"></div>
        </main>

        <!-- Ø³Ø§ÙŠØ¯Ø¨Ø§Ø± ÙŠÙ…ÙŠÙ†: Ø¥Ø´Ø¹Ø§Ø±Ø§Øª + Ø¯Ø±Ø¯Ø´Ø© (ØªØµÙ…ÙŠÙ… ÙÙ‚Ø· Ø­Ø§Ù„ÙŠØ§Ù‹) -->
        <aside class="sidebar-right">
          <div class="sidebar-title">
            <i class="fa-regular fa-bell"></i> Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
          </div>
          <div class="placeholder-box">
            Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹.<br />
            Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø¢Ø®Ø± Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª ÙˆØ§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ù‡Ù†Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹.
          </div>

          <div class="sidebar-title">
            <i class="fa-regular fa-comments"></i> Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©
          </div>
          <div class="placeholder-box">
            Ù‚Ø³Ù… Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø³ÙŠÙƒÙˆÙ† Ù‡Ù†Ø§.<br />
            ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹ Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ ÙˆØ§Ù„Ø±Ø³Ø§Ø¦Ù„.
          </div>
        </aside>
      </div>
    </div>

    <!-- Ù…Ù„Ù Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ -->
    <script src="assets/js/app.js"></script>

    <!-- Ø³ÙƒØ±Ø¨Øª Ø¨Ø³ÙŠØ· Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ ÙˆÙ…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
    <script>
      // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ Ù…Ù† /api/profile
      async function loadCurrentUserProfile() {
        let token =
          localStorage.getItem("token") || localStorage.getItem("authToken");

        if (!token) return;

        try {
          const res = await fetch("/api/profile", {
            headers: {
              Authorization: "Bearer " + token,
            },
          });

          if (!res.ok) return;

          const data = await res.json();

          // Ù…Ù„Ø¡ Ø§Ù„Ù‡ÙŠØ¯Ø±
          const navUserName = document.getElementById("navUserName");
          const navUserAvatar = document.getElementById("navUserAvatar");

          if (navUserName) navUserName.textContent = data.username || "Ù…Ø³ØªØ®Ø¯Ù…";
          if (navUserAvatar && data.avatar) navUserAvatar.src = data.avatar;

          // Ù…Ù„Ø¡ Ø§Ù„Ø³Ø§ÙŠØ¯Ø¨Ø§Ø±
          const sideUserName = document.getElementById("sideUserName");
          const sideUserEmail = document.getElementById("sideUserEmail");
          const sideUserAvatar = document.getElementById("sideUserAvatar");

          if (sideUserName) sideUserName.textContent = data.username || "";
          if (sideUserEmail) sideUserEmail.textContent = data.email || "";
          if (sideUserAvatar && data.avatar) sideUserAvatar.src = data.avatar;

          // Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨
          const welcome = document.getElementById("welcomeUser");
          if (welcome) {
            welcome.textContent = "Ù…Ø±Ø­Ø¨Ø§Ù‹ ğŸ‘‹ " + (data.username || "");
          }
        } catch (err) {
          console.error("Error loading profile in index:", err);
        }
      }

      loadCurrentUserProfile();
    </script>
  </body>
</html>
