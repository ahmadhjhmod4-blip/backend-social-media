<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - Saepel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: radial-gradient(
          circle at top left,
          #28357a 0,
          #050814 40%,
          #000 100%
        );
        color: #f5f7ff;
        overflow: hidden;
      }

      .bg-orbs {
        position: fixed;
        inset: 0;
        z-index: -1;
        pointer-events: none;
        overflow: hidden;
      }

      .bg-orb {
        position: absolute;
        width: 380px;
        height: 380px;
        border-radius: 50%;
        filter: blur(60px);
        opacity: 0.35;
      }

      .bg-orb:nth-child(1) {
        background: #4f46e5;
        top: -80px;
        right: -100px;
      }

      .bg-orb:nth-child(2) {
        background: #ec4899;
        bottom: -100px;
        left: -80px;
      }

      .bg-orb:nth-child(3) {
        background: #22c55e;
        top: 40%;
        left: 50%;
        transform: translate(-50%, -50%);
        opacity: 0.18;
      }

      .card {
        width: 100%;
        max-width: 410px;
        padding: 28px 26px 30px;
        border-radius: 26px;
        background: rgba(15, 23, 42, 0.72);
        border: 1px solid rgba(148, 163, 184, 0.25);
        backdrop-filter: blur(22px);
        box-shadow: 0 20px 60px rgba(15, 23, 42, 0.9);
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 18px;
      }

      .brand-logo {
        width: 38px;
        height: 38px;
        border-radius: 16px;
        background: radial-gradient(circle at 20% 20%, #a855f7, #0ea5e9);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 18px;
      }

      .brand-text-title {
        font-size: 20px;
        font-weight: 700;
        letter-spacing: 0.04em;
      }

      .brand-text-sub {
        font-size: 12px;
        color: #cbd5f5;
      }

      h1 {
        font-size: 20px;
        margin-bottom: 6px;
      }

      .subtitle {
        font-size: 13px;
        color: #cbd5f5;
        margin-bottom: 18px;
      }

      form {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .field {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      label {
        font-size: 13px;
        color: #e5e7eb;
      }

      .input-wrapper {
        position: relative;
      }

      .input-wrapper i {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        color: #9ca3af;
        font-size: 14px;
      }

      .input-wrapper i.left {
        right: 12px;
      }

      .input-wrapper i.toggle-password {
        left: 12px;
        cursor: pointer;
      }

      input[type="email"],
      input[type="password"],
      input[type="text"] {
        width: 100%;
        padding: 10px 36px 10px 36px;
        border-radius: 999px;
        border: 1px solid rgba(148, 163, 184, 0.45);
        background: rgba(15, 23, 42, 0.78);
        color: #f9fafb;
        font-size: 13px;
        outline: none;
        transition: border 0.18s, box-shadow 0.18s, background 0.18s;
      }

      input::placeholder {
        color: #6b7280;
      }

      input:focus {
        border-color: #38bdf8;
        box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.5);
        background: rgba(15, 23, 42, 0.98);
      }

      .actions-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 4px;
        margin-bottom: 4px;
      }

      .checkbox-wrapper {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 12px;
        color: #d1d5db;
      }

      .checkbox-wrapper input {
        width: 14px;
        height: 14px;
      }

      .link {
        font-size: 12px;
        color: #38bdf8;
        cursor: pointer;
        text-decoration: none;
      }

      .link:hover {
        text-decoration: underline;
      }

      .btn-primary {
        margin-top: 6px;
        width: 100%;
        padding: 10px 0;
        border-radius: 999px;
        border: none;
        background: linear-gradient(135deg, #0ea5e9, #6366f1);
        color: white;
        font-weight: 600;
        font-size: 14px;
        cursor: pointer;
        transition: transform 0.12s ease, box-shadow 0.12s ease,
          filter 0.12s ease;
      }

      .btn-primary:hover {
        transform: translateY(-1px);
        box-shadow: 0 12px 24px rgba(59, 130, 246, 0.45);
        filter: brightness(1.03);
      }

      .btn-primary:active {
        transform: translateY(0);
        box-shadow: none;
        filter: brightness(0.98);
      }

      .footer-txt {
        margin-top: 14px;
        font-size: 12px;
        text-align: center;
        color: #9ca3af;
      }

      .footer-txt a {
        color: #38bdf8;
      }

      .alert {
        margin-bottom: 8px;
        padding: 8px 10px;
        border-radius: 10px;
        font-size: 12px;
      }

      .alert-error {
        background: rgba(248, 113, 113, 0.12);
        border: 1px solid rgba(248, 113, 113, 0.5);
        color: #fecaca;
      }

      .alert-success {
        background: rgba(52, 211, 153, 0.12);
        border: 1px solid rgba(52, 211, 153, 0.6);
        color: #bbf7d0;
      }

      @media (max-width: 480px) {
        .card {
          margin: 16px;
          padding: 22px 18px 24px;
          border-radius: 22px;
        }

        h1 {
          font-size: 18px;
        }
      }
    </style>
  </head>
  <body>
    <div class="bg-orbs">
      <div class="bg-orb"></div>
      <div class="bg-orb"></div>
      <div class="bg-orb"></div>
    </div>

    <div class="card">
      <div class="brand">
        <div class="brand-logo">S</div>
        <div>
          <div class="brand-text-title">Saepel</div>
          <div class="brand-text-sub">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ø¹ÙˆØ¯ØªÙƒ ğŸ‘‹</div>
        </div>
      </div>

      <h1>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h1>
      <p class="subtitle">ØªØ§Ø¨Ø¹ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ù…Ø¬ØªÙ…Ø¹Ùƒ ÙÙŠ Saepel.</p>

      <div id="loginMessage" class="alert" style="display: none"></div>

      <form id="loginForm">
        <div class="field">
          <label for="loginIdentifier">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
          <div class="input-wrapper">
            <i class="fa-regular fa-envelope left"></i>
            <input
              id="loginIdentifier"
              type="text"
              placeholder="example@domain.com Ø£Ùˆ @username"
              autocomplete="username"
              required
            />
          </div>
        </div>

        <div class="field">
          <label for="loginPassword">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
          <div class="input-wrapper">
            <i class="fa-solid fa-lock left"></i>
            <input
              id="loginPassword"
              type="password"
              placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
              autocomplete="current-password"
              required
            />
            <i
              class="fa-regular fa-eye toggle-password"
              id="toggleLoginPassword"
            ></i>
          </div>
        </div>

        <div class="actions-row">
          <label class="checkbox-wrapper">
            <input type="checkbox" id="rememberMe" />
            <span>ØªØ°ÙƒØ±Ù†ÙŠ</span>
          </label>
          <a href="#" class="link">Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ</a>
        </div>

        <button type="submit" class="btn-primary" id="loginBtn">
          ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        </button>
      </form>

      <p class="footer-txt">
        Ù…Ø§ Ø¹Ù†Ø¯Ùƒ Ø­Ø³Ø§Ø¨ØŸ <a href="register.html">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</a>
      </p>
    </div>

    <script>
      // âœ… Ù†Ø³ØªØ®Ø¯Ù… Ù†ÙØ³ Ø§Ù„Ø£ØµÙ„ (origin) Ø§Ù„Ù„ÙŠ Ø§Ù„ØµÙØ­Ø© Ø´ØºÙ‘Ø§Ù„Ø© Ù…Ù†Ù‡
      // Ù…Ø«Ù„Ø§Ù‹: http://localhost:5000 Ø£Ùˆ https://your-app.onrender.com
      const API_BASE = window.location.origin + "/api";

      const loginForm = document.getElementById("loginForm");
      const loginMessage = document.getElementById("loginMessage");
      const loginBtn = document.getElementById("loginBtn");

      const loginPasswordInput = document.getElementById("loginPassword");
      const toggleLoginPassword = document.getElementById("toggleLoginPassword");

      toggleLoginPassword.addEventListener("click", () => {
        const isPassword = loginPasswordInput.type === "password";
        loginPasswordInput.type = isPassword ? "text" : "password";
        toggleLoginPassword.classList.toggle("fa-eye");
        toggleLoginPassword.classList.toggle("fa-eye-slash");
      });

      function showLoginMessage(text, type = "error") {
        loginMessage.style.display = "block";
        loginMessage.textContent = text;
        loginMessage.className =
          "alert " + (type === "error" ? "alert-error" : "alert-success");
      }

      loginForm.addEventListener("submit", async (e) => {
        e.preventDefault();

        const identifier = document
          .getElementById("loginIdentifier")
          .value.trim();
        const password = loginPasswordInput.value;

        if (!identifier || !password) {
          showLoginMessage(
            "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯/Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.",
            "error"
          );
          return;
        }

        loginBtn.disabled = true;
        loginBtn.textContent = "Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...";

        try {
          const res = await fetch(API_BASE + "/auth/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ identifier, password }),
          });

          const data = await res.json();

          if (!res.ok) {
            showLoginMessage(data.msg || "Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.", "error");
          } else {
            // Ø®Ø²Ù† Ø§Ù„ØªÙˆÙƒÙ† ÙˆØ§Ù„ÙŠÙˆØ²Ø±
            if (data.token) localStorage.setItem("token", data.token);
            if (data.user)
              localStorage.setItem("user", JSON.stringify(data.user));

            showLoginMessage(
              "ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­ØŒ Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­ÙˆÙŠÙ„...",
              "success"
            );

            // ØªØ­ÙˆÙŠÙ„ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (index.html)
            setTimeout(() => {
              window.location.href = "/"; // Ø§Ù„Ø³ÙŠØ±ÙØ± Ø¨ÙŠØ±Ø¬Ø¹ index.html Ø¹Ù„Ù‰ "/"
            }, 800);
          }
        } catch (err) {
          console.error(err);
          showLoginMessage("Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.", "error");
        } finally {
          loginBtn.disabled = false;
          loginBtn.textContent = "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„";
        }
      });
    </script>
  </body>
</html>
